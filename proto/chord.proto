syntax = "proto3";

option java_multiple_files = true;
option java_package = "onezero.chord";
option java_outer_classname = "ChordProto";
option objc_class_prefix = "CRD";

package chord;

// The greeting service definition.
service Chord {
  // send a greeting
  rpc say_hello (HelloRequest)      returns (HelloReply) {}
  rpc successor (SuccessorRequest)  returns (SuccessorResponse) {}
  rpc join      (JoinRequest)       returns (JoinResponse) {}
  rpc stabilize (StabilizeRequest)  returns (StabilizeResponse) {}
  rpc notify    (NotifyRequest)     returns (NotifyResponse) {}
}

/**
 * COMMON
 */
message RouterEntry {
  string uuid = 1;
  string endpoint = 2;
}
message Header {
  RouterEntry src = 1;
  //RouterEntry dst = 2;
}

/**
 * SUCCESSOR 
 */
message SuccessorRequest {
  Header header = 1;
  //--- id to find
  string id = 2;
}

message SuccessorResponse { 
  Header header = 1;
  RouterEntry successor = 2;
}

/**
 * JOIN
 */
message JoinRequest {
  Header header = 1;
}

message JoinResponse { 
  Header header = 1;
  RouterEntry successor = 2;
}

/**
 * STABILIZE
 */
message StabilizeRequest {
  Header header = 1;
}
message StabilizeResponse {
  Header header = 1;
}

/**
 * NOTIFY
 */
message NotifyRequest {
  Header header = 1;
}
message NotifyResponse {
  Header header = 1;
}


/**
 * HELLO
 */
// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloReply {
  string message = 1;
}
